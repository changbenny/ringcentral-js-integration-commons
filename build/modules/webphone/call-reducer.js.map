{"version":3,"sources":["modules/webphone/call-reducer.js"],"names":[],"mappings":";;;;;;;;;;kBA2Be,UAAU,KAAV,EAAiB,MAAjB,EAAyB;AACtC,MAAI,OAAO,KAAP,KAAiB,WAArB,EAAkC,OAAO,sBAAc,EAAd,EAAkB,YAAlB,CAAP;AAClC,MAAI,CAAC,MAAL,EAAa,OAAO,KAAP;AACb,UAAQ,OAAO,IAAf;;AAEE,SAAK,sBAAY,KAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,eAAO,OAAO;AADgB,OAAzB,CAAP;AAGF,SAAK,sBAAY,KAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,YAAlB,CAAP;AACF,SAAK,sBAAY,MAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,QAAQ,MAAM,MAAd,EAAsB,qBAAW,SAAjC,IACE,MAAM,MADR,GAEE,MAAM,MAAN,CAAa,MAAb,CAAoB,qBAAW,SAA/B;AAHoB,OAAzB,CAAP;AAKF,SAAK,sBAAY,UAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,OAAO,MAAM,MAAb,EAAqB,qBAAW,SAAhC;AADsB,OAAzB,CAAP;AAGF,SAAK,sBAAY,IAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,QAAQ,MAAM,MAAd,EAAsB,qBAAW,KAAjC,IACE,MAAM,MADR,GAEE,MAAM,MAAN,CAAa,MAAb,CAAoB,qBAAW,KAA/B;AAHoB,OAAzB,CAAP;AAKF,SAAK,sBAAY,MAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,OAAO,MAAM,MAAb,EAAqB,qBAAW,KAAhC;AADsB,OAAzB,CAAP;AAGF,SAAK,sBAAY,IAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,QAAQ,MAAM,MAAd,EAAsB,qBAAW,OAAjC,IACE,MAAM,MADR,GAEE,MAAM,MAAN,CAAa,MAAb,CAAoB,qBAAW,OAA/B,CAHoB;AAI9B,kBAAU,CAAC,MAAD,EAAS,QAAT;AAJoB,OAAzB,CAAP;AAMF,SAAK,sBAAY,MAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,OAAO,MAAM,MAAb,EAAqB,qBAAW,OAAhC,CADsB;AAE9B,kBAAU;AAFoB,OAAzB,CAAP;AAIF,SAAK,sBAAY,IAAjB;;AAEE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,QAAQ,MAAM,MAAd,EAAsB,qBAAW,MAAjC,IACE,MAAM,MADR,GAEE,MAAM,MAAN,CAAa,MAAb,CAAoB,qBAAW,MAA/B;AAHoB,OAAzB,CAAP;AAKF,SAAK,sBAAY,QAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,QAAQ,MAAM,MAAd,EAAsB,qBAAW,UAAjC,IACE,MAAM,MADR,GAEE,MAAM,MAAN,CAAa,MAAb,CAAoB,qBAAW,UAA/B,CAHoB;AAI9B,uBAAe,OAAO,OAAP,CAAe;AAJA,OAAzB,CAAP;AAMF,SAAK,sBAAY,IAAjB;AACE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,QAAQ,MAAM,MAAd,EAAsB,qBAAW,IAAjC,IACE,MAAM,MADR,GAEE,MAAM,MAAN,CAAa,MAAb,CAAoB,qBAAW,IAA/B,CAHoB;AAI9B,oBAAY,OAAO,OAAP,CAAe;AAJG,OAAzB,CAAP;AAMF,SAAK,sBAAY,IAAjB;;AAEE,aAAO,sBAAc,EAAd,EAAkB,KAAlB,EAAyB;AAC9B,gBAAQ,MAAM,MAAN,CAAa,MAAb,CAAoB,qBAAW,MAA/B,CADsB;AAE9B,oBAAY,OAAO,OAAP,CAAe;AAFG,OAAzB,CAAP;;AAKF;AACE,aAAO,KAAP;AArEJ;AAuED,C;;AArGD;;;;AACA;;;;;;AAEA,SAAS,OAAT,CAAiB,GAAjB,EAAsB,GAAtB,EAA2B;AACzB,SAAO,IAAI,OAAJ,CAAY,GAAZ,IAAmB,CAAC,CAA3B;AACD;;AAED,SAAS,MAAT,CAAgB,GAAhB,EAAqB,GAArB,EAA0B;AACxB,MAAI,QAAQ,GAAR,EAAa,GAAb,CAAJ,EAAuB;AACrB,QAAI,MAAJ,CAAW,IAAI,OAAJ,CAAY,GAAZ,CAAX,EAA6B,CAA7B;AACD;AACD,SAAO,GAAP;AACD;;AAED,IAAM,eAAe;;AAEnB,UAAQ,EAFW;;AAInB,YAAU,EAJS;;AAMnB,iBAAe,IANI;AAOnB,cAAY,IAPO;AAQnB,cAAY,IARO;;AAUnB,SAAO;AAVY,CAArB","file":"call-reducer.js","sourcesContent":["import callActions from './call-actions';\nimport callStatus from './call-status';\n\nfunction contain(arr, ele) {\n  return arr.indexOf(ele) > -1;\n}\n\nfunction remove(arr, ele) {\n  if (contain(arr, ele)) {\n    arr.splice(arr.indexOf(ele), 1);\n  }\n  return arr;\n}\n\nconst initialState = {\n  // operations which is enable\n  status: [],\n  // some operations will disable another, such as 'hold'\n  disabled: [],\n  // some operations have infomation need to be stored\n  transferTaget: null,\n  flipTarget: null,\n  dtmfNumber: null,\n  // operation error\n  error: null,\n};\n\nexport default function (state, action) {\n  if (typeof state === 'undefined') return Object.assign({}, initialState);\n  if (!action) return state;\n  switch (action.type) {\n\n    case callActions.error:\n      return Object.assign({}, state, {\n        error: action.error,\n      });\n    case callActions.clear:\n      return Object.assign({}, initialState);\n    case callActions.record:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.recording) ?\n                  state.status :\n                  state.status.concat(callStatus.recording),\n      });\n    case callActions.stopRecord:\n      return Object.assign({}, state, {\n        status: remove(state.status, callStatus.recording),\n      });\n    case callActions.mute:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.muted) ?\n                  state.status :\n                  state.status.concat(callStatus.muted),\n      });\n    case callActions.unmute:\n      return Object.assign({}, state, {\n        status: remove(state.status, callStatus.muted),\n      });\n    case callActions.hold:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.holding) ?\n                  state.status :\n                  state.status.concat(callStatus.holding),\n        disabled: ['park', 'record'],\n      });\n    case callActions.unhold:\n      return Object.assign({}, state, {\n        status: remove(state.status, callStatus.holding),\n        disabled: [],\n      });\n    case callActions.park:\n      // https://en.wikipedia.org/wiki/Call_parking\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.parker) ?\n                  state.status :\n                  state.status.concat(callStatus.parker),\n      });\n    case callActions.transfer:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.transfered) ?\n                  state.status :\n                  state.status.concat(callStatus.transfered),\n        transferTaget: action.payload.number,\n      });\n    case callActions.flip:\n      return Object.assign({}, state, {\n        status: contain(state.status, callStatus.flip) ?\n                  state.status :\n                  state.status.concat(callStatus.flip),\n        flipTarget: action.payload.number,\n      });\n    case callActions.dtmf:\n      // TODO: clarify park action\n      return Object.assign({}, state, {\n        status: state.status.concat(callStatus.parked),\n        dtmfNumber: action.payload.number,\n      });\n\n    default:\n      return state;\n  }\n}\n"]}